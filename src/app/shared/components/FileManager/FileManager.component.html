<!-- file-manager.component.html -->
<div class="row">
  <div class="col-12">
    <div class="row mb-4">
      <div class="col-12">
        <!-- Upload Section -->
        <div class="card border-0 shadow-sm">
          <div class="card-body p-4">
            <!-- Title -->
            <div class="mb-3">
              <label class="form-label fw-bold text-dark">
                <i class="pi pi-cloud-upload me-2"></i>{{ label }}
              </label>
              <small class="text-muted d-block">
                Max size: {{ maxFileSizeMB }} MB | Type: {{ fileType === 'all' ? 'All files' : fileType }}
              </small>
            </div>

            <!-- File Input Area -->
            <div class="form-floating mb-3">
              <div class="file-input-wrapper">
                <input type="file" #fileInput (change)="onFileSelected($event)" class="form-control d-none"
                  [attr.accept]="getAcceptAttribute()" [disabled]="isUploading || mode === 'view'" />

                <button type="button"
                  class="btn btn-primary w-100 d-flex align-items-center justify-content-center gap-2 text-black"
                  (click)="fileInput.click()" [disabled]="isUploading || mode === 'view'">
                  <i class="pi pi-upload"></i>
                  {{ isUploading ? 'Uploading...' : 'Choose File' }}
                </button>
              </div>

              <!-- Progress Bar -->
              <div *ngIf="isUploading" class="mt-3">
                <div class="progress" style="height: 25px;">
                  <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar"
                    [style.width.%]="uploadProgress" [attr.aria-valuenow]="uploadProgress" aria-valuemin="0"
                    aria-valuemax="100">
                    {{ uploadProgress }}%
                  </div>
                </div>
              </div>
            </div>

            <!-- Info Message -->
            <div *ngIf="!allowMultiple && files.length > 0" class="alert alert-info alert-sm mb-0">
              <i class="pi pi-info-circle me-2"></i>
              <small>Upload a new file to replace the existing one</small>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Files List Section -->
    <div *ngIf="files.length > 0" class="row mb-4">
      <div class="col-12">
        <div class="card border-0 shadow-sm">
          <div class="card-body p-4">
            <h6 class="card-title mb-3">
              <i class="pi pi-list me-2"></i>Uploaded Files ({{ files.length }})
            </h6>

            <!-- Files Table -->
            <div class="table-responsive">
              <table class="table table-hover mb-0">
                <thead class="table-light">
                  <tr>
                    <th style="width: 40px;"></th>
                    <th>File Name</th>
                    <th style="width: 150px;">File Hint</th>
                    <th style="width: 100px;">Size</th>
                    <th style="width: 150px;">Uploaded</th>
                    <th style="width: 150px;">Actions</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let file of files; let i = index">
                    <!-- File Icon -->
                    <td class="text-center">
                      <i [class]="'pi ' + getFileIcon(file.fileName)" style="font-size: 1.5rem;"></i>
                    </td>

                    <!-- File Name -->
                    <td>
                      <div class="fw-500 text-truncate" [title]="file.fileName">
                        {{ file.fileName }}
                      </div>
                      <small class="text-muted">{{ file.filePath }}</small>
                    </td>
                    <td>
                      <input type="text" class="form-control form-text" style="width: 150px;"
                        [(ngModel)]="file.fileHint">
                      <br>
                      <button type="button" class="btn btn-outline-info w-100" title="Preview" (click)="EditHint()">
                        <i class="pi pi-save"></i>
                      </button>
                    </td>

                    <!-- File Size -->
                    <td>
                      <span class="badge bg-light text-dark">
                        {{ getFileSize(file.fileSizeKB) }}
                      </span>
                    </td>

                    <!-- Upload Date -->
                    <td>
                      <small class="text-muted">
                        {{ file.uploadDate | date: 'short' }}
                      </small>
                    </td>

                    <!-- Actions -->
                    <td>
                      <div class="btn-group btn-group-sm" role="group">
                        <!-- Download Button -->
                        <button type="button" class="btn btn-outline-primary" title="Download"
                          (click)="downloadFile(file)">
                          <i class="pi pi-download"></i>
                        </button>

                        <!-- Preview Button -->
                        <button type="button" class="btn btn-outline-info" title="Preview" (click)="previewFile(file)">
                          <i class="pi pi-eye"></i>
                        </button>

                        <!-- Delete Button -->
                        <button *ngIf="mode === 'edit'" type="button" class="btn btn-outline-danger" title="Delete"
                          (click)="removeFile(file.id)">
                          <i class="pi pi-trash"></i>
                        </button>
                      </div>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <!-- Clear All Button -->
            <div *ngIf="mode === 'edit'" class="mt-3 text-end">
              <button type="button" class="btn btn-sm btn-outline-danger" (click)="clearFiles()">
                <i class="pi pi-trash me-2"></i>Clear All
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Empty State -->
    <div *ngIf="files.length === 0 && !isUploading" class="row">
      <div class="col-12">
        <div class="alert alert-light border-2 text-center py-5">
          <i class="pi pi-folder-open text-muted" style="font-size: 3rem;"></i>
          <p class="text-muted mt-3 mb-0">No files uploaded yet</p>
        </div>
      </div>
    </div>
  </div>
</div>