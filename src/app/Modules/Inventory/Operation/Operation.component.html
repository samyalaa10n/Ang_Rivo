<div dir="rtl">
    <p-button [raised]="true" [routerLink]="['/Main/OperationList']" routerLinkActive="router-link-active"
        severity="info" label="رجوع الي قائمة العمليات المخزنية" icon="pi pi-arrow-right"
        class=" btn-lg px-5 py-3 fw-bold shadow-sm"></p-button>
    <div class="row justify-content-center my-3">
        <div class="col-12 col-xl-10">

            <!-- Header -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="card shadow-sm border-0">
                        <div class="card-body p-4">
                            <div class="row align-items-center">
                                <div class="col-12 col-md-6">
                                    <h2 class="mb-0 fw-bold text-primary" *ngIf="Operation.ID==0">
                                        <i class="me-2"></i>
                                        إنشاء عملية جديدة
                                    </h2>
                                    <h2 class="mb-0 fw-bold text-primary" *ngIf="Operation.ID>0">
                                        <i class="pi pi-shopping-cart me-2"></i>
                                        بيانات العملية المخزنية
                                    </h2>
                                </div>
                                <div class="col-12 col-md-6 mt-3 mt-md-0">
                                    <div class="form-floating">
                                        <input type="text" [(ngModel)]="Operation.ID" class="form-control"
                                            placeholder="رقم الطلبية" readonly>
                                        <label class="text-muted">
                                            <i class="pi pi-hashtag me-2"></i>رقم العملية
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Form -->
            <div class="row g-4">

                <!-- Right Section - Form Fields -->
                <div class="col-12 col-lg-8">
                    <div class="card shadow-sm border-0 h-100">
                        <div class="card-body p-4">

                            <!-- Type Selection -->
                            <div class="row mb-4  my-4">
                                <div class="col-12">
                                    <div class="form-floating">
                                        <app-comboBox [NormalStyle]="true"
                                            [dataSource]="[{ID:1,NAME:'اضافة'},{ID:2,NAME:'سحب'},{ID:3,NAME:'تحويل'}]"
                                            optionValue="ID" optionLabel="NAME"
                                            [(SelectedValue)]="Operation.TYPE" class="form-control"></app-comboBox>
                                        <label class="text-muted">
                                            <i class="pi pi-database me-2"></i>نوع العملية
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <!-- WareHouses add Selection -->
                            <div class="row mb-4  my-4" *ngIf="Operation.TYPE>0">
                                <div class="col-12">
                                    <div class="form-floating">
                                        <app-comboBox [NormalStyle]="true" [dataSource]="WareHouses" optionValue="ID"
                                            optionLabel="NAME" apiPathDataSource="WareHouse"
                                            [(SelectedValue)]="Operation.WAREHOUSE_ADDED_ID"
                                            class="form-control"></app-comboBox>
                                        <label class="text-muted">
                                            <i class="pi pi-database me-2"></i>
                                            <span *ngIf="Operation.TYPE==1">الي مخزن</span>
                                            <span *ngIf="Operation.TYPE==2 || Operation.TYPE==3">من مخزن</span>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <!-- WareHouses get Selection -->
                            <div class="row mb-4  my-4" *ngIf="Operation.TYPE==3">
                                <div class="col-12">
                                    <div class="form-floating">
                                        <app-comboBox [NormalStyle]="true" [dataSource]="WareHouses" optionValue="ID"
                                            optionLabel="NAME" apiPathDataSource="WareHouse"
                                            [(SelectedValue)]="Operation.WAREHOUSE_GET_ID"
                                            class="form-control"></app-comboBox>
                                        <label class="text-muted">
                                            <i class="pi pi-database me-2"></i>
                                            <span>الي مخزن</span>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <!-- Date Fields -->
                            <div class="row mb-4 ">
                                <div class="col-12 col-md-6 ">
                                    <div class="form-floating">
                                        <app-DateTime [(selectedDate)]="Operation.DATE_TIME"
                                            class="form-control"></app-DateTime>
                                        <label class="text-muted">
                                            <i class="pi pi-calendar me-2"></i>تاريخ التسجيل
                                        </label>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>

                <!-- Left Section - Calculations & Notes -->
                <div class="col-12 col-lg-4">
                    <div class="row g-3">
                        <!-- Notes Card -->
                        <div class="col-12">
                            <div class="card shadow-sm border-0">
                                <div class="card-header bg-light border-0">
                                    <h5 class="mb-0 fw-bold text-secondary">
                                        <i class="pi pi-comment me-2"></i>الملاحظات
                                    </h5>
                                </div>
                                <div class="card-body p-3">
                                    <div class="form-floating">
                                        <textarea [(ngModel)]="Operation.NOTS" class="form-control"
                                            style="height: 120px; resize: vertical;"
                                            placeholder="اكتب الملاحظات هنا..."></textarea>
                                        <label class="text-muted">اكتب الملاحظات هنا...</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Items Section -->
            <div class="row mt-4">
                <div class="col-12">
                    <div class="card shadow-sm border-0">
                        <div class="card-header bg-light border-0">
                            <h5 class="mb-0 fw-bold text-secondary">
                                <i class="pi pi-list me-2"></i>اصناف العملية المخزنية
                            </h5>
                        </div>
                        <div class="card-body">
                            <app-InputFastItems #InputFastItems [ITEMS_INPUT]="Operation.ITEMS" Header="اصناف العملية المخزنية" [showPrice]="false"
                                (OnGridLoaded)="GridLoaded($event)"></app-InputFastItems>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Save Button -->
            <div class="row mt-4">
                <div class="col-12">
                    <div class="d-grid gap-2 d-md-flex justify-content-md-center">
                        <p-button *ngIf=" this.Operation.ID==0" [raised]="true" (onClick)="Save()" severity="success"
                            label="اضافة العملية وطباعة" icon="pi pi-save"
                            class="btn-lg px-5 py-3 fw-bold shadow-sm"></p-button>
                        <p-button *ngIf=" this.Operation.ID>0" [raised]="true" (onClick)="Save()" severity="success"
                            label="حفظ تعديل العملية وطباعة" icon="pi pi-save"
                            class="btn-lg px-5 py-3 fw-bold shadow-sm"></p-button>
                        <p-button *ngIf=" this.Operation.ID>0" [raised]="true" (onClick)="delete()" severity="danger"
                            label="حذف العملية" icon="pi pi-trash"
                            class="btn-lg px-5 py-3 fw-bold shadow-sm"></p-button>
                        <p-button *ngIf=" this.Operation.ID>0" [raised]="true" (onClick)="AddNew()" severity="info"
                            label="عملية جديدة" icon="pi pi-plus" class="btn-lg px-5 py-3 fw-bold shadow-sm"></p-button>
                        <p-button *ngIf=" this.Operation.ID>0" [raised]="true" (onClick)="AddInhert()" severity="info"
                            label="عملية جديدة بنفس البيانات" icon="pi pi-plus" severity="info"
                            class="btn-lg px-5 py-3 fw-bold shadow-sm"></p-button>
                    </div>
                </div>
            </div>

        </div>
    </div>

</div>