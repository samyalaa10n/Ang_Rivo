<div dir="ltr">
    <p-button [raised]="true" [routerLink]="['/Main/OperationList']" routerLinkActive="router-link-active"
        severity="info" label="Back to Inventory Operations List" icon="pi pi-arrow-left"
        class=" btn-lg px-5 py-3 fw-bold shadow-sm"></p-button>
    <div class="row justify-content-center my-3">
        <div class="col-12 col-xl-10">

            <!-- Header -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="card shadow-sm border-0">
                        <div class="card-body p-4">
                            <div class="row align-items-center">
                                <div class="col-12 col-md-6">
                                    <h2 class="mb-0 fw-bold text-primary" *ngIf="Operation.ID==0">
                                        <i class="me-2"></i>
                                        Create New Operation
                                    </h2>
                                    <h2 class="mb-0 fw-bold text-primary" *ngIf="Operation.ID>0">
                                        <i class="pi pi-shopping-cart me-2"></i>
                                        Inventory Operation Details
                                    </h2>
                                </div>
                                <div class="col-12 col-md-6 mt-3 mt-md-0">
                                    <div class="form-floating">
                                        <input type="text" [(ngModel)]="Operation.ID" class="form-control"
                                            placeholder="Operation Number" readonly>
                                        <label class="text-muted">
                                            <i class="pi pi-hashtag me-2"></i>Operation Number
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Form -->
            <div class="row g-4">

                <!-- Right Section - Form Fields -->
                <div class="col-12 col-lg-8">
                    <div class="card shadow-sm border-0 h-100">
                        <div class="card-body p-4">

                            <!-- Type Selection -->
                            <div class="row mb-4  my-4">
                                <div class="col-12">
                                    <div class="form-floating">
                                        <app-comboBox [ShowMode]="Operation.ID>0" [NormalStyle]="true"
                                            [dataSource]="[{ID:1,NAME:'Add'},{ID:2,NAME:'Withdraw'},{ID:3,NAME:'Transfer'}]"
                                            optionValue="ID" optionLabel="NAME"
                                            [(SelectedValue)]="Operation.TYPE" class="form-control"></app-comboBox>
                                        <label class="text-muted">
                                            <i class="pi pi-database me-2"></i>Operation Type
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <!-- WareHouses add Selection -->
                            <div class="row mb-4  my-4" *ngIf="Operation.TYPE>0">
                                <div class="col-12">
                                    <div class="form-floating">
                                        <app-comboBox [ShowMode]="Operation.ID>0" [NormalStyle]="true" [dataSource]="WareHouses" optionValue="ID" 
                                            optionLabel="NAME" apiPathDataSource="WareHouse"
                                            [(SelectedValue)]="Operation.WAREHOUSE_1" (SelectedValueChange)="GetDataRecordedStock()"
                                            class="form-control"></app-comboBox>
                                        <label class="text-muted">
                                            <i class="pi pi-database me-2"></i>
                                            <span *ngIf="Operation.TYPE==1">To Warehouse</span>
                                            <span *ngIf="Operation.TYPE==2 || Operation.TYPE==3">From Warehouse</span>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <!-- WareHouses get Selection -->
                            <div class="row mb-4  my-4" *ngIf="Operation.TYPE==3">
                                <div class="col-12">
                                    <div class="form-floating">
                                        <app-comboBox [ShowMode]="Operation.ID>0" [NormalStyle]="true" [dataSource]="WareHouses" optionValue="ID"
                                            optionLabel="NAME" apiPathDataSource="WareHouse"
                                            [(SelectedValue)]="Operation.WAREHOUSE_2"
                                            class="form-control"></app-comboBox>
                                        <label class="text-muted">
                                            <i class="pi pi-database me-2"></i>
                                            <span>To Warehouse</span>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <!-- Date Fields -->
                            <div class="row mb-4 ">
                                <div class="col-12 col-md-6 ">
                                    <div class="form-floating">
                                        <app-DateTime [ShowMode]="Operation.ID>0" [(selectedDate)]="Operation.DATE_TIME"
                                            class="form-control"></app-DateTime>
                                        <label class="text-muted">
                                            <i class="pi pi-calendar me-2"></i>Registration Date
                                        </label>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>

                <!-- Left Section - Calculations & Notes -->
                <div class="col-12 col-lg-4">
                    <div class="row g-3">
                        <!-- Notes Card -->
                        <div class="col-12">
                            <div class="card shadow-sm border-0">
                                <div class="card-header bg-light border-0">
                                    <h5 class="mb-0 fw-bold text-secondary">
                                        <i class="pi pi-comment me-2"></i>Notes
                                    </h5>
                                </div>
                                <div class="card-body p-3">
                                    <div class="form-floating">
                                        <textarea [(ngModel)]="Operation.NOTS" [disabled]="Operation.ID>0" class="form-control"
                                            style="height: 120px; resize: vertical;"
                                            placeholder="Write notes here..."></textarea>
                                        <label class="text-muted">Write notes here...</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Items Section -->
            <div class="row mt-4">
                <div class="col-12">
                    <div class="card shadow-sm border-0">
                        <div class="card-header bg-light border-0">
                            <h5 class="mb-0 fw-bold text-secondary">
                                <i class="pi pi-list me-2"></i>Inventory Operation Items
                            </h5>
                        </div>
                        <div class="card-body">
                            <app-InputFastItems [ShowMode]="Operation.ID>0" #InputFastItems  Header="Inventory Operation Items" [showPrice]="false"
                                (OnGridLoaded)="GridLoaded($event)"></app-InputFastItems>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Save Button -->
            <div class="row mt-4">
                <div class="col-12">
                    <div class="d-grid gap-2 d-md-flex justify-content-md-center">
                        <p-button *ngIf=" this.Operation.ID==0" [raised]="true" (onClick)="Save()" severity="success"
                            label="Add Operation & Print" icon="pi pi-save"
                            class="btn-lg px-5 py-3 fw-bold shadow-sm"></p-button>
                        <p-button *ngIf=" this.Operation.ID>0" [raised]="true" (onClick)="print(true)" severity="success"
                            label="Print" icon="pi pi-print"
                            class="btn-lg px-5 py-3 fw-bold shadow-sm"></p-button>
                        <p-button *ngIf=" this.Operation.ID>0" [raised]="true" (onClick)="delete()" severity="danger"
                            label="Delete Operation" icon="pi pi-trash"
                            class="btn-lg px-5 py-3 fw-bold shadow-sm"></p-button>
                        <p-button *ngIf=" this.Operation.ID>0" [raised]="true" (onClick)="AddNew()" severity="info"
                            label="New Operation" icon="pi pi-plus" class="btn-lg px-5 py-3 fw-bold shadow-sm"></p-button>
                        <p-button *ngIf=" this.Operation.ID>0" [raised]="true" (onClick)="AddInhert()" severity="info"
                            label="New Operation with Same Data" icon="pi pi-plus" severity="info"
                            class="btn-lg px-5 py-3 fw-bold shadow-sm"></p-button>
                    </div>
                </div>
            </div>

        </div>
    </div>

</div>